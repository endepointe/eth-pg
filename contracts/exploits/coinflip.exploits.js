const CoinFlipContract = artifacts.require('CoinFlip');
const CoinFlipAttackContract = artifacts.require('CoinFlipAttack');
const assert = require('assert');

async function execute(callback) {

  // set the instance that represents the default address managed by 
  // each contract.

  let victimContract = await CoinFlipContract.deployed();
  let attackerContract = await CoinFlipAttackContract.deployed();

  await attackerContract.setVictim(victimContract.address);

  for (let i = 0; i < 10; ++i) {
    await attackerContract.flip();
  }

  let count = await victimContract.consecutiveWins.call();
  assert.equal(wins.toNumber(), 10);
  console.log(`Rolled ${count} consecutive times.`);

  callback();
}

module.exports = execute;